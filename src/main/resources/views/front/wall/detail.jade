doctype html
html(lang='')
  head
    meta(charset='utf-8')
    meta(http-equiv='X-UA-Compatible', content='IE=edge')
    meta(name='viewport', content='width=device-width, initial-scale=1')
    title 照片墙详情页
    // Bootstrap CSS
    link(rel='stylesheet', href='${request.contextPath}/assets/libs/bootstrap/dist/css/bootstrap.min.css')
    link(rel='stylesheet', href='${request.contextPath}/assets/libs/wookmark/css/main.css')

    //app.css
    link(rel='stylesheet', href='${request.contextPath}/assets/css/app.css')
    // HTML5 Shim and Respond.js IE8 support of HTML5 elements and media queries
    // WARNING: Respond.js doesn't work if you view the page via file://
    | <!--[if lte IE 9]> <script src="./assets/libs/html5shiv/dist/html5shiv.min.js"></script>
    | <script src="./assets/libs/respond.js/dest/respond.min.js"></script><![endif]-->
    | <!--[if lte IE 8]> <p class="text-center" style="display:block;background-color:#eaddac;padding:5px;color:#900;font-size:16px;">对不起，本网站不支持IE8以及IE8以下版本，为获得更好的体验，建议您更新为IE9及以上版本，本网站推荐使用谷歌浏览器，祝您生活愉快。</p> <![endif]-->
  body
    .app-header
      include ../common/navigation
    .app-content
      .app-wall
        | 详情页面
    .app-footer
    // jQuery
    script(src='${request.contextPath}/assets/libs/jquery/dist/jquery.min.js')
    // Bootstrap JavaScript
    script(src='${request.contextPath}/assets/libs/bootstrap/dist/js/bootstrap.min.js')
    script(src='${request.contextPath}/assets/libs/imagesloaded/imagesloaded.pkgd.min.js')
    script(src='${request.contextPath}/assets/libs/wookmark/wookmark.min.js')
    // IE10 viewport hack for Surface/desktop Windows 8 bug
    script.
        (function ($) {
            // Instantiate wookmark after all images have been loaded
            var wookmark,
                container = '#container',
                $container = $(container),
                $window = $(window),
                $document = $(document);

            imagesLoaded(container, function () {
                wookmark = new Wookmark(container, {
                    offset: 15, // Optional, the distance between grid items
                    itemWidth: 300 // Optional, the width of a grid item
                });
            });
            /**
             * When scrolled all the way to the bottom, add more tiles
             */
            function onScroll() {
                // Check if we're within 100 pixels of the bottom edge of the broser window.
                var winHeight = window.innerHeight ? window.innerHeight : $window.height(), // iphone fix
                    closeToBottom = ($window.scrollTop() + winHeight > $document.height() - 100);

                if (closeToBottom) {
                    // Get the first then items from the grid, clone them, and add them to the bottom of the grid
                    var $items = $('li', $container),
                        $firstTen = $items.slice(0, 10).clone().css('opacity', 0);
                    $container.append($firstTen);

                    wookmark.initItems();
                    wookmark.layout(true, function () {
                        // Fade in items after layout
                        setTimeout(function () {
                            $firstTen.css('opacity', 1);
                        }, 300);
                    });
                }
            };

            // Capture scroll event.
            $window.bind('scroll.wookmark', onScroll);
        })(jQuery);
